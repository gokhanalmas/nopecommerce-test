/*
* Copyright 2012 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { $(".attributeFilterPanel7Spikes .filtersGroupPanel a[data-option-ids]").each(function () { var a = new AttributeFiltersManager; $(this).click(a.filterProductsByProductAttributeOption) }) }); function AttributeFiltersManager() { } AttributeFiltersManager.prototype.filterProductsByProductAttributeOption = FilterProductsByProductAttributeOption; AttributeFiltersManager.prototype.buildAttributeFiltersModel = BuildAttributeFiltersModel; AttributeFiltersManager.prototype.refreshAttributeFilters = RefreshAttributeFilters; FiltersManager.prototype.buildAttributeFiltersModel = (new AttributeFiltersManager).buildAttributeFiltersModel; FiltersManager.prototype.refreshAttributeFilters = (new AttributeFiltersManager).refreshAttributeFilters; function BuildAttributeFiltersModel(a, c) { var b = {}; b.CategoryId = a; b.AttributeFilterGroups = []; $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (a, e) { var g = $(e).attr("data-optionsGroupId"), h = {}; h.Id = g; void 0 != c && c.get(0) == e && (h.IsMain = !0, b.Priority = 1); h.FilterItems = []; $(e).find("a[data-option-ids]").each(function (c, a) { var b = $(a).text(), b = $.trim(b), e = $(a).attr("data-option-ids"), d = $(a).attr("class"), f = {}, e = e.split(","); f.Name = b; f.ProductVariantAttributeIds = e; f.FilterItemState = (new FiltersManager).getFilterItemStateBasedOnItemClass(d, f.FilterItemState); h.FilterItems.push(f) }); b.AttributeFilterGroups.push(h) }); return b } function RefreshAttributeFilters(a, c) { $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (b, d) { var e = $(d).attr("data-optionsGroupId"), g = $.grep(a.AttributeFilterGroups, function (a) { return a.Id == e }); if (0 != g.length) { var h = g[0]; if (c && "usedropdowns" == c) var j = !0; $(d).find("a[data-option-ids]").each(function (a, b) { var d = $(b).text(), g = $.trim(d), d = $(b).attr("class"), f = $.grep(h.FilterItems, function (a) { return a.Name == g }); 0 != f.length && (f = f[0], c && (1 == f.FilterItemState && "usedropdowns" == c) && (j = !1, SetDropDownSelectedElementForAttributeFilters(e, b)), $(b).attr("class", (new FiltersManager).getFilterItemClassBasedOnState(f.FilterItemState, d))) }); c && ("usedropdowns" == c && !0 == j) && (g = $(d).find(".allFilterDropDownOptions")[0], SetDropDownSelectedElementForAttributeFilters(e, g)) } }) } function SetDropDownSelectedElementForAttributeFilters(a, c) { var b = $("#attributeFiltersDropDown" + a), d = $(c).parent(), e = b.get(0); d.siblings().removeClass("selected"); d.addClass("selected"); e.selectedLiElement = d; b.find("p").text($(c).text()) } function FilterProductsByProductAttributeOption(a) { a = $(a.currentTarget); var c = a.parents("div[data-optionsGroupId]"); (new FiltersManager).requestProductsForSelectedFilters(c, a) };